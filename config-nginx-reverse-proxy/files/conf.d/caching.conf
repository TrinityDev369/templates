# =============================================================================
# caching.conf — Proxy Cache Path Definitions (http context)
# =============================================================================
# Defines disk-backed cache zones for Nginx's proxy cache.
# Included at the http level in nginx.conf.
# Cache usage directives (proxy_cache, proxy_cache_valid, etc.) are applied
# per-location in default.conf.
#
# Two zones:
#   static_cache  — long-lived cache for static assets (JS, CSS, images, fonts)
#   dynamic_cache — short-lived cache for dynamic/API responses (optional)
# =============================================================================

# -----------------------------------------------------------------------------
# Static content cache
# -----------------------------------------------------------------------------
# levels:       Two-level directory hierarchy (avoids too many files per dir)
# keys_zone:    Shared memory for cache keys — 10m holds ~80,000 keys
# max_size:     Maximum total disk usage for this cache
# inactive:     Evict entries not accessed within this window
# use_temp_path: off = write directly to cache dir (avoids double-write)
proxy_cache_path /var/cache/nginx/static
    levels=1:2
    keys_zone=static_cache:10m
    max_size=1g
    inactive=7d
    use_temp_path=off;

# -----------------------------------------------------------------------------
# Dynamic content cache
# -----------------------------------------------------------------------------
proxy_cache_path /var/cache/nginx/dynamic
    levels=1:2
    keys_zone=dynamic_cache:10m
    max_size=512m
    inactive=1h
    use_temp_path=off;

# -----------------------------------------------------------------------------
# Cache key — uniquely identifies each cached response
# -----------------------------------------------------------------------------
proxy_cache_key "$scheme$request_method$host$request_uri";
